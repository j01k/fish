<!DOCTYPE html>
<html>
<head profile="http://www.crystalfishlabs.com">
<link rel="icon" 
      type="image/png" 
      href="https://raw.githubusercontent.com/j01k/fish/master/fish.png">
<style>
.button {
  background-color: white;
  border: none;
  color: cyan;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 50px;
  margin: 5px 5px;
  cursor: pointer;
}
.roll {
  background-color: white;
  border: 1px solid black;
  color: black;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 24px;
  cursor: pointer;
}
</style>
<title>CrystalFishLabs</title>
</head>
<body>
<button class="button" title="50% catch rate"onclick="bait()">&gt;&lt;&gt;</button>

<p id="fish"></p>

<form id="rateinput">
  Rate: <input type="text" name="rate" value="">
</form>

<form id="kcinput">
  Desired Attempts: <input type="text" name="kc" value="">
</form>

<button class="roll" onclick="go()">Roll</button>

<p id="results"></p>
<p id="results2"></p>

<script>
//fishFunctions
var fishCaught = 0;
var attempts = 0;
function fish() {
	if (getRandomInt(100) > 50) {
		return "You catch a fish. You have caught " + fishCaught+++ " out of " + attempts++
				+ " attempts with a success rate of " + fishCaught/attempts;
			
    }
    else {
    	return "You fail to catch a fish. You have caught " + fishCaught + " out of " + attempts++
	    	+ " attempts with a success rate of " + fishCaught/attempts;
    }
    	
}

function bait() {
	document.getElementById("fish").innerHTML = fish();
}

//roll functions
var attempts = 1;
var scenarios = 1;

function getData(formName) {
  var x = document.getElementById(formName);
  var text = "";
  var i;
  for (i = 0; i < x.length ;i++) {
    text += x.elements[i].value;
  }
  return text;
}

function chance(rate) {
	while (getRandomInt(rate) != (rate - 1)) {
    	attempts++;
    }
    scenarios++;
    return attempts;
}

function whatIf(rate, kc) {
	while (attempts <= kc) {
    	chance(rate);
        if (attempts >= kc) {
        	return attempts;
         }
         else {
         	attempts = 0;
         }
     }
 }
        
function go() {
	attempts = 1;
    scenarios = 1;
    document.getElementById("results").innerHTML = "It took you " + chance(getData("rateinput")) + " attempts!";
    if (getData("kcinput") > 0) {
    	document.getElementById("results2").innerHTML = "It took you" + whatIf(getData("rateinput"), 			getData("kcinput")) + " attempts and " + scenarios + " pets were caught in the process.";
    }
    
}

//misc functions 
function getRandomInt(max) {
  return Math.floor(Math.random() * Math.floor(max));
}

</script>
</body>
</html>
